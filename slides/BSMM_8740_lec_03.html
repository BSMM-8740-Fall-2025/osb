<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.54">

  <meta name="author" content="derived from Max Kuhn (RStudio)">
  <title>BSMM-8740 - Fall 2024 – The recipes package</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="The recipes package – BSMM-8740 - Fall 2024">
<meta property="og:description" content="BSMM8740-2-R-2024F [WEEK - 3]">
<meta property="og:site_name" content="BSMM-8740 - Fall 2024">
<meta name="twitter:title" content="The recipes package – BSMM-8740 - Fall 2024">
<meta name="twitter:description" content="BSMM8740-2-R-2024F [WEEK - 3]">
<meta name="twitter:image" content="https://bsmm-8740-fall-2024.github.io/osb/slides/images/twitter-card.png">
<meta name="twitter:creator" content="@lodette">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">The recipes package</h1>
  <p class="subtitle">BSMM8740-2-R-2024F [WEEK - 3]</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
derived from Max Kuhn (RStudio) 
</div>
</div>
</div>

</section>
<section id="recap-of-last-lecture" class="slide level2">
<h2>Recap of last lecture</h2>
<ul>
<li>Last time we worked with exploratory data analysis and then used the tidyverse verbs to engineer features into our datasets.</li>
</ul>
</section>
<section id="todays-outline" class="slide level2">
<h2>Today’s Outline</h2>
<ul>
<li>We’ll review the R model formula approach to model specification,</li>
<li>We’ll introducte data pre-processing and design/model matrix generation with the <code>recipes</code> package, and</li>
<li>We’ll show how using recipes will facilitate developing feature engineering workflows that can be applied to multiple datasets (e.g.&nbsp;train and test as well as cross-validation<sup>1</sup> datasets)</li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn1"><p>Cross-validation is a resampling method that uses different portions of the data to test and train a model on different iterations.</p></li></ol></aside></section>
<section id="r-model-formulas" class="slide level2">
<h2>R Model Formulas</h2>
<p>A simple formula in a linear model to predict house prices (using the dataset Sacremento from the package <code>modeldata</code>):</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" data-code-line-numbers="1|2|3|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="sc">&gt;</span> Sacramento <span class="ot">&lt;-</span> modeldata<span class="sc">::</span>Sacramento</span>
<span id="cb1-2"><a></a><span class="sc">&gt;</span> mod1 <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(</span>
<span id="cb1-3"><a></a><span class="sc">+</span>   <span class="fu">log</span>(price) <span class="sc">~</span> type <span class="sc">+</span> sqft</span>
<span id="cb1-4"><a></a><span class="sc">+</span>   , <span class="at">data =</span> Sacramento</span>
<span id="cb1-5"><a></a><span class="sc">+</span>   , <span class="at">subset =</span> beds <span class="sc">&gt;</span> <span class="dv">2</span></span>
<span id="cb1-6"><a></a><span class="sc">+</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div style="font-size: 60%">
<p>The purpose of this code chunk:</p>
<ol type="1">
<li>subset some of the observations (<code>subset</code>)</li>
<li>create a design matrix for 2 predictor variable (but 3 model terms)</li>
<li>log transform the outcome variable</li>
<li>fit a linear regression model</li>
</ol>
<p>The first two steps create the <em>design-</em> or <em>model- matrix</em>.</p>
</div>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<p>The dataset Sacramento has three categorical variables:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" data-code-line-numbers="1|2|3|4|5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="sc">&gt;</span> skimr<span class="sc">::</span><span class="fu">skim</span>(Sacramento) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a></a><span class="sc">+</span>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(skim_variable,<span class="fu">contains</span>(<span class="st">'factor'</span>)) ) <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a></a><span class="sc">+</span>   tidyr<span class="sc">::</span><span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a></a><span class="sc">+</span>   gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-5"><a></a><span class="sc">+</span>   gtExtras<span class="sc">:::</span><span class="fu">gt_theme_espn</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-6"><a></a><span class="sc">+</span>   gt<span class="sc">::</span><span class="fu">tab_options</span>( <span class="at">table.font.size =</span> gt<span class="sc">::</span><span class="fu">px</span>(<span class="dv">20</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a></a><span class="sc">+</span>   gt<span class="sc">::</span><span class="fu">as_raw_html</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="dvmskgduug" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
  
  
<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false" style="-webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'; display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 20px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 3px; border-top-color: #FFFFFF; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3;" data-bgcolor="#FFFFFF">
<thead style="border-style: none;">
<tr class="header gt_col_headings" style="border-style: none; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3;">
<th id="skim_variable" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col" style="text-align: left; border-style: none; color: #333333; background-color: #FFFFFF; font-size: 80%; font-weight: bolder; text-transform: uppercase; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden;" data-bgcolor="#FFFFFF" data-valign="bottom">skim_variable</th>
<th id="factor.ordered" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col" style="text-align: center; border-style: none; color: #333333; background-color: #FFFFFF; font-size: 80%; font-weight: bolder; text-transform: uppercase; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden;" data-bgcolor="#FFFFFF" data-valign="bottom">factor.ordered</th>
<th id="factor.n_unique" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col" style="text-align: right; border-style: none; color: #333333; background-color: #FFFFFF; font-size: 80%; font-weight: bolder; text-transform: uppercase; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-bgcolor="#FFFFFF" data-valign="bottom">factor.n_unique</th>
<th id="factor.top_counts" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col" style="text-align: left; border-style: none; color: #333333; background-color: #FFFFFF; font-size: 80%; font-weight: bolder; text-transform: uppercase; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden;" data-bgcolor="#FFFFFF" data-valign="bottom">factor.top_counts</th>
</tr>
</thead>
<tbody class="gt_table_body" style="border-style: none; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3;">
<tr class="odd" style="border-style: none;">
<td class="gt_row gt_left" headers="skim_variable" style="text-align: left; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">city</td>
<td class="gt_row gt_center" headers="factor.ordered" style="text-align: center; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">FALSE</td>
<td class="gt_row gt_right" headers="factor.n_unique" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-valign="middle">37</td>
<td class="gt_row gt_left" headers="factor.top_counts" style="text-align: left; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">SAC: 438, ELK: 114, ROS: 48, CIT: 35</td>
</tr>
<tr class="even" style="border-style: none;">
<td class="gt_row gt_left gt_striped" headers="skim_variable" style="text-align: left; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA;" data-valign="middle" data-bgcolor="#FAFAFA">zip</td>
<td class="gt_row gt_center gt_striped" headers="factor.ordered" style="text-align: center; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA;" data-valign="middle" data-bgcolor="#FAFAFA">FALSE</td>
<td class="gt_row gt_right gt_striped" headers="factor.n_unique" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA; font-variant-numeric: tabular-nums;" data-valign="middle" data-bgcolor="#FAFAFA">68</td>
<td class="gt_row gt_left gt_striped" headers="factor.top_counts" style="text-align: left; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA;" data-valign="middle" data-bgcolor="#FAFAFA">z95: 61, z95: 45, z95: 44, z95: 37</td>
</tr>
<tr class="odd" style="border-style: none;">
<td class="gt_row gt_left" headers="skim_variable" style="text-align: left; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">type</td>
<td class="gt_row gt_center" headers="factor.ordered" style="text-align: center; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">FALSE</td>
<td class="gt_row gt_right" headers="factor.n_unique" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-valign="middle">3</td>
<td class="gt_row gt_left" headers="factor.top_counts" style="text-align: left; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Res: 866, Con: 53, Mul: 13</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="example-design-matrix" class="slide level2">
<h2>Example design matrix</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" data-code-line-numbers="1|2|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="sc">&gt;</span>  mm <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(</span>
<span id="cb3-2"><a></a><span class="sc">+</span>    <span class="fu">log</span>(price) <span class="sc">~</span> type <span class="sc">+</span> sqft</span>
<span id="cb3-3"><a></a><span class="sc">+</span>    , <span class="at">data =</span> Sacramento</span>
<span id="cb3-4"><a></a><span class="sc">+</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) typeMulti_Family typeResidential sqft
1            1                0               1  836
2            1                0               1 1167
3            1                0               1  796
4            1                0               1  852
5            1                0               1  797
6            1                0               0 1122
7            1                0               1 1104
8            1                0               1 1177
9            1                0               0  941
10           1                0               1 1146
11           1                0               1  909
12           1                0               1 1289
13           1                0               1  871
14           1                0               1 1020</code></pre>
</div>
</div>
</section>
<section id="summary-model-formula-method" class="slide level2">
<h2>Summary: Model Formula Method</h2>
<ul>
<li>Model formulas are very expressive in that they can represent model terms easily</li>
<li>The formula/terms framework does some elegant functional programming</li>
<li>Functions can be embedded inline to do fairly complex things (on single variables) and these can be applied to new data sets.</li>
</ul>
</section>
<section id="model-formula-examples" class="slide level2">
<h2>Model formula examples</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">leave out</a></li><li><a href="#tabset-1-2">interaction</a></li><li><a href="#tabset-1-3">crossing</a></li><li><a href="#tabset-1-4">nesting</a></li><li><a href="#tabset-1-5">as-is</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a><span class="sc">&gt;</span> <span class="fu">model.matrix</span>(<span class="fu">log</span>(price) <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> type <span class="sc">+</span> sqft, <span class="at">data =</span> Sacramento) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  typeCondo typeMulti_Family typeResidential sqft
1         0                0               1  836
2         0                0               1 1167
3         0                0               1  796
4         0                0               1  852
5         0                0               1  797
6         1                0               0 1122</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a><span class="sc">&gt;</span> <span class="fu">model.matrix</span>(<span class="fu">log</span>(price) <span class="sc">~</span> type <span class="sc">:</span> sqft, <span class="at">data =</span> Sacramento) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) typeCondo:sqft typeMulti_Family:sqft typeResidential:sqft
1           1              0                     0                  836
2           1              0                     0                 1167
3           1              0                     0                  796
4           1              0                     0                  852
5           1              0                     0                  797
6           1           1122                     0                    0</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a><span class="sc">&gt;</span> <span class="fu">model.matrix</span>(<span class="fu">log</span>(price) <span class="sc">~</span> type <span class="sc">*</span> sqft, <span class="at">data =</span> Sacramento) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) typeMulti_Family typeResidential sqft typeMulti_Family:sqft
1           1                0               1  836                     0
2           1                0               1 1167                     0
3           1                0               1  796                     0
4           1                0               1  852                     0
5           1                0               1  797                     0
6           1                0               0 1122                     0
  typeResidential:sqft
1                  836
2                 1167
3                  796
4                  852
5                  797
6                    0</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="sc">&gt;</span> <span class="fu">model.matrix</span>(<span class="fu">log</span>(price) <span class="sc">~</span> type <span class="sc">%in%</span> sqft, <span class="at">data =</span> Sacramento) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) typeCondo:sqft typeMulti_Family:sqft typeResidential:sqft
1           1              0                     0                  836
2           1              0                     0                 1167
3           1              0                     0                  796
4           1              0                     0                  852
5           1              0                     0                  797
6           1           1122                     0                    0</code></pre>
</div>
</div>
</div>
<div id="tabset-1-5">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a><span class="sc">&gt;</span> <span class="fu">model.matrix</span>(<span class="fu">log</span>(price) <span class="sc">~</span> type <span class="sc">+</span> sqft <span class="sc">+</span> <span class="fu">I</span>(sqft<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> Sacramento) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) typeMulti_Family typeResidential sqft I(sqft^2)
1           1                0               1  836    698896
2           1                0               1 1167   1361889
3           1                0               1  796    633616
4           1                0               1  852    725904
5           1                0               1  797    635209
6           1                0               0 1122   1258884</code></pre>
</div>
</div>
<p>contrast with log(price) ~ type + sqft + sqft^2</p>
</div>
</div>
</div>
</section>
<section id="summary-model-formula-method-1" class="slide level2">
<h2>Summary: Model Formula Method</h2>
<p>There are significant limitations to what this framework can do and, in some cases, it can be very inefficient.</p>
<p>This is mostly due to being written well before large scale modeling and machine learning were commonplace.</p>
</section>
<section id="limitations-of-the-current-system" class="slide level2">
<h2>Limitations of the Current System</h2>
<ul>
<li>Formulas are not very extensible especially with nested or sequential operations (e.g.&nbsp;<code>y ~ scale(center(knn_impute(x)))</code>).</li>
<li>When used in modeling functions, you cannot recycle the previous computations.</li>
<li>For wide data sets with lots of columns, the formula method can be very inefficient and consume a significant proportion of the total execution time.</li>
</ul>
</section>
<section id="limitations-of-the-current-system-1" class="slide level2">
<h2>Limitations of the Current System</h2>
<ul>
<li>Multivariate outcomes are kludgy by requiring <code>cbind</code> .</li>
<li>Formulas have a limited set of roles for measurements (just <code>predictor</code> and <code>outcome</code>). We’ll look further at roles in the next two slides.</li>
</ul>
<p>A more in-depth discussion of these issues can be found in <a href="https://rviews.rstudio.com/2017/03/01/the-r-formula-method-the-bad-parts/">this blog post</a> (recommended to read).</p>
</section>
<section id="variable-roles" class="slide level2">
<h2>Variable Roles</h2>
<p>Formulas have been re-implemented in different packages for a variety of different reasons:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15" data-code-line-numbers="3|8-10|14-16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a><span class="sc">&gt;</span> <span class="co"># ?lme4::lmer</span></span>
<span id="cb15-2"><a></a><span class="er">&gt;</span> <span class="co"># Subjects need to be in the data but are not part of the model</span></span>
<span id="cb15-3"><a></a><span class="er">&gt;</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(Reaction <span class="sc">~</span> Days <span class="sc">+</span> (Days <span class="sc">|</span> Subject), <span class="at">data =</span> lme4<span class="sc">::</span>sleepstudy)</span>
<span id="cb15-4"><a></a><span class="sc">&gt;</span> </span>
<span id="cb15-5"><a></a><span class="er">&gt;</span> <span class="co"># BradleyTerry2</span></span>
<span id="cb15-6"><a></a><span class="er">&gt;</span> <span class="co"># We want to make the outcomes to be a function of a </span></span>
<span id="cb15-7"><a></a><span class="er">&gt;</span> <span class="co"># competitor-specific function of reach </span></span>
<span id="cb15-8"><a></a><span class="er">&gt;</span> BradleyTerry2<span class="sc">::</span><span class="fu">BTm</span>(<span class="at">outcome =</span> <span class="dv">1</span>, <span class="at">player1 =</span> winner, <span class="at">player2 =</span> loser,</span>
<span id="cb15-9"><a></a><span class="sc">+</span>     <span class="at">formula =</span> <span class="sc">~</span> reach[..] <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>..), </span>
<span id="cb15-10"><a></a><span class="sc">+</span>     <span class="at">data =</span> boxers)</span>
<span id="cb15-11"><a></a><span class="sc">&gt;</span> </span>
<span id="cb15-12"><a></a><span class="er">&gt;</span> <span class="co"># modeltools::ModelEnvFormula (using the modeltools package for formulas)</span></span>
<span id="cb15-13"><a></a><span class="er">&gt;</span> <span class="co"># mob</span></span>
<span id="cb15-14"><a></a><span class="er">&gt;</span> <span class="fu">data</span>(PimaIndiansDiabetes, <span class="at">package =</span> <span class="st">'mlbench'</span>)</span>
<span id="cb15-15"><a></a><span class="sc">&gt;</span> modeltools<span class="sc">::</span><span class="fu">ModelEnvFormula</span>(diabetes <span class="sc">~</span> glucose <span class="sc">|</span> pregnant <span class="sc">+</span> mass <span class="sc">+</span>  age,</span>
<span id="cb15-16"><a></a><span class="sc">+</span>     <span class="at">data =</span> PimaIndiansDiabetes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variable-roles-1" class="slide level2">
<h2>Variable Roles</h2>
<p>A general list of possible variable roles could be:</p>
<div style="font-size: 75%">
<ul>
<li>outcomes</li>
<li>predictors</li>
<li>stratification</li>
<li>model performance data (e.g.&nbsp;loan amount to compute expected loss)</li>
<li>conditioning or faceting variables (e.g.&nbsp;<a href="https://cran.r-project.org/package=lattice"><code>lattice</code></a> or <a href="https://cran.r-project.org/package=ggplot2"><code>ggplot2</code></a>)</li>
<li>random effects or hierarchical model ID variables</li>
<li>case weights (*)</li>
<li>offsets (*)</li>
<li>error terms (limited to <code>Error</code> in the <code>aov</code> function)(*)</li>
</ul>
<p>(*) Can be handled in formulas but are hard-coded into functions.</p>
</div>
</section>
<section>
<section id="the-recipes-package" class="title-slide slide level1 center">
<h1>The Recipes package</h1>

</section>
<section id="recipes" class="slide level2">
<h2>Recipes</h2>
<p>We can approach the design matrix and preprocessing steps by first specifying a <strong>sequence of steps</strong>.</p>
<ol type="1">
<li><code>price</code> is an outcome</li>
<li><code>type</code> and <code>sqft</code> are predictors</li>
<li>log transform <code>price</code></li>
<li>convert <code>type</code> to dummy variables</li>
</ol>
</section>
<section id="recipes-1" class="slide level2">
<h2>Recipes</h2>
<p>A recipe is a specification of <em>intent</em>.</p>
<p>One issue with the formula method is that it couples the specification for your predictors along with the implementation.</p>
<p>Recipes separate the <em>planning</em> from the <em>doing</em>.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>The Recipes website is found at: <a href="https://topepo.github.io/recipes"><code>https://topepo.github.io/recipes</code></a></p>
</div>
</div>
</div>
</section>
<section id="recipes-2" class="slide level2">
<h2>Recipes</h2>
<p>Once created, a <em>recipe</em> can be <code>prep</code>ped on training data then <code>bake</code>d with any other data.</p>
<div style="font-size: smaller">
<ul>
<li>the <code>prep</code> step calculates and stores variables related to the steps (e.g.&nbsp;(min,max) for scaling), using the training data</li>
<li>the <code>bake</code> step applies the steps to new data</li>
</ul>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16" data-code-line-numbers="2|4-6|9|11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a><span class="sc">&gt;</span> <span class="do">## Create an initial recipe with only predictors and outcome</span></span>
<span id="cb16-2"><a></a><span class="er">&gt;</span> rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(price <span class="sc">~</span> type <span class="sc">+</span> sqft, <span class="at">data =</span> Sacramento)</span>
<span id="cb16-3"><a></a><span class="sc">&gt;</span> </span>
<span id="cb16-4"><a></a><span class="er">&gt;</span> rec <span class="ot">&lt;-</span> rec <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">step_log</span>(price) <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">step_dummy</span>(type)</span>
<span id="cb16-7"><a></a><span class="sc">&gt;</span> </span>
<span id="cb16-8"><a></a><span class="er">&gt;</span> <span class="co"># estimate any parameters</span></span>
<span id="cb16-9"><a></a><span class="er">&gt;</span> rec_trained <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(rec, <span class="at">training =</span> Sacramento, <span class="at">retain =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-10"><a></a><span class="sc">&gt;</span> <span class="co"># apply the computations to new_data</span></span>
<span id="cb16-11"><a></a><span class="er">&gt;</span> design_mat  <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">bake</span>(rec_trained, <span class="at">new_data =</span> Sacramento)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="selecting-variables" class="slide level2">
<h2>Selecting Variables</h2>
<p>In the last slide, we used <code>dplyr</code>-like syntax for selecting variables such as <code>step_dummy(type)</code>.</p>
<p>In some cases, the names of the predictors may not be known at the time when you construct a recipe (or model formula). For example:</p>
<ul>
<li>dummy variable columns</li>
<li>PCA feature extraction when you keep components that capture <span class="math inline">\(\mathrm{X}\%\)</span> of the variability.</li>
<li>discretized predictors with dynamic bins</li>
</ul>
</section>
<section id="example-1" class="slide level2">
<h2>Example</h2>
<p>Using the <code>airquality</code> dataset in the <code>datasets</code> package</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17" data-code-line-numbers="1|3-4|5-8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a><span class="sc">&gt;</span> dat <span class="ot">&lt;-</span> datasets<span class="sc">::</span>airquality</span>
<span id="cb17-2"><a></a><span class="sc">&gt;</span> </span>
<span id="cb17-3"><a></a><span class="er">&gt;</span> dat <span class="sc">%&gt;%</span> skimr<span class="sc">::</span><span class="fu">skim</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a></a><span class="sc">+</span>   dplyr<span class="sc">::</span><span class="fu">select</span>(skim_variable<span class="sc">:</span>numeric.sd) <span class="sc">%&gt;%</span> </span>
<span id="cb17-5"><a></a><span class="sc">+</span>   gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a></a><span class="sc">+</span>   gtExtras<span class="sc">:::</span><span class="fu">gt_theme_espn</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb17-7"><a></a><span class="sc">+</span>   gt<span class="sc">::</span><span class="fu">tab_options</span>( <span class="at">table.font.size =</span> gt<span class="sc">::</span><span class="fu">px</span>(<span class="dv">20</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb17-8"><a></a><span class="sc">+</span>   gt<span class="sc">::</span><span class="fu">as_raw_html</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="bkenmthrri" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
  
  
<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false" style="-webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'; display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 20px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 3px; border-top-color: #FFFFFF; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3;" data-bgcolor="#FFFFFF">
<thead style="border-style: none;">
<tr class="header gt_col_headings" style="border-style: none; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3;">
<th id="skim_variable" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col" style="text-align: left; border-style: none; color: #333333; background-color: #FFFFFF; font-size: 80%; font-weight: bolder; text-transform: uppercase; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden;" data-bgcolor="#FFFFFF" data-valign="bottom">skim_variable</th>
<th id="n_missing" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col" style="text-align: right; border-style: none; color: #333333; background-color: #FFFFFF; font-size: 80%; font-weight: bolder; text-transform: uppercase; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-bgcolor="#FFFFFF" data-valign="bottom">n_missing</th>
<th id="complete_rate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col" style="text-align: right; border-style: none; color: #333333; background-color: #FFFFFF; font-size: 80%; font-weight: bolder; text-transform: uppercase; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-bgcolor="#FFFFFF" data-valign="bottom">complete_rate</th>
<th id="numeric.mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col" style="text-align: right; border-style: none; color: #333333; background-color: #FFFFFF; font-size: 80%; font-weight: bolder; text-transform: uppercase; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-bgcolor="#FFFFFF" data-valign="bottom">numeric.mean</th>
<th id="numeric.sd" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col" style="text-align: right; border-style: none; color: #333333; background-color: #FFFFFF; font-size: 80%; font-weight: bolder; text-transform: uppercase; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-bgcolor="#FFFFFF" data-valign="bottom">numeric.sd</th>
</tr>
</thead>
<tbody class="gt_table_body" style="border-style: none; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3;">
<tr class="odd" style="border-style: none;">
<td class="gt_row gt_left" headers="skim_variable" style="text-align: left; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Ozone</td>
<td class="gt_row gt_right" headers="n_missing" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-valign="middle">37</td>
<td class="gt_row gt_right" headers="complete_rate" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-valign="middle">0.7581699</td>
<td class="gt_row gt_right" headers="numeric.mean" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-valign="middle">42.129310</td>
<td class="gt_row gt_right" headers="numeric.sd" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-valign="middle">32.987885</td>
</tr>
<tr class="even" style="border-style: none;">
<td class="gt_row gt_left gt_striped" headers="skim_variable" style="text-align: left; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA;" data-valign="middle" data-bgcolor="#FAFAFA">Solar.R</td>
<td class="gt_row gt_right gt_striped" headers="n_missing" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA; font-variant-numeric: tabular-nums;" data-valign="middle" data-bgcolor="#FAFAFA">7</td>
<td class="gt_row gt_right gt_striped" headers="complete_rate" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA; font-variant-numeric: tabular-nums;" data-valign="middle" data-bgcolor="#FAFAFA">0.9542484</td>
<td class="gt_row gt_right gt_striped" headers="numeric.mean" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA; font-variant-numeric: tabular-nums;" data-valign="middle" data-bgcolor="#FAFAFA">185.931507</td>
<td class="gt_row gt_right gt_striped" headers="numeric.sd" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA; font-variant-numeric: tabular-nums;" data-valign="middle" data-bgcolor="#FAFAFA">90.058422</td>
</tr>
<tr class="odd" style="border-style: none;">
<td class="gt_row gt_left" headers="skim_variable" style="text-align: left; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Wind</td>
<td class="gt_row gt_right" headers="n_missing" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-valign="middle">0</td>
<td class="gt_row gt_right" headers="complete_rate" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-valign="middle">1.0000000</td>
<td class="gt_row gt_right" headers="numeric.mean" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-valign="middle">9.957516</td>
<td class="gt_row gt_right" headers="numeric.sd" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-valign="middle">3.523001</td>
</tr>
<tr class="even" style="border-style: none;">
<td class="gt_row gt_left gt_striped" headers="skim_variable" style="text-align: left; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA;" data-valign="middle" data-bgcolor="#FAFAFA">Temp</td>
<td class="gt_row gt_right gt_striped" headers="n_missing" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA; font-variant-numeric: tabular-nums;" data-valign="middle" data-bgcolor="#FAFAFA">0</td>
<td class="gt_row gt_right gt_striped" headers="complete_rate" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA; font-variant-numeric: tabular-nums;" data-valign="middle" data-bgcolor="#FAFAFA">1.0000000</td>
<td class="gt_row gt_right gt_striped" headers="numeric.mean" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA; font-variant-numeric: tabular-nums;" data-valign="middle" data-bgcolor="#FAFAFA">77.882353</td>
<td class="gt_row gt_right gt_striped" headers="numeric.sd" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA; font-variant-numeric: tabular-nums;" data-valign="middle" data-bgcolor="#FAFAFA">9.465270</td>
</tr>
<tr class="odd" style="border-style: none;">
<td class="gt_row gt_left" headers="skim_variable" style="text-align: left; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Month</td>
<td class="gt_row gt_right" headers="n_missing" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-valign="middle">0</td>
<td class="gt_row gt_right" headers="complete_rate" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-valign="middle">1.0000000</td>
<td class="gt_row gt_right" headers="numeric.mean" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-valign="middle">6.993464</td>
<td class="gt_row gt_right" headers="numeric.sd" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; font-variant-numeric: tabular-nums;" data-valign="middle">1.416522</td>
</tr>
<tr class="even" style="border-style: none;">
<td class="gt_row gt_left gt_striped" headers="skim_variable" style="text-align: left; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA;" data-valign="middle" data-bgcolor="#FAFAFA">Day</td>
<td class="gt_row gt_right gt_striped" headers="n_missing" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA; font-variant-numeric: tabular-nums;" data-valign="middle" data-bgcolor="#FAFAFA">0</td>
<td class="gt_row gt_right gt_striped" headers="complete_rate" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA; font-variant-numeric: tabular-nums;" data-valign="middle" data-bgcolor="#FAFAFA">1.0000000</td>
<td class="gt_row gt_right gt_striped" headers="numeric.mean" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA; font-variant-numeric: tabular-nums;" data-valign="middle" data-bgcolor="#FAFAFA">15.803922</td>
<td class="gt_row gt_right gt_striped" headers="numeric.sd" style="text-align: right; border-style: none; padding-top: 7px; padding-bottom: 7px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #F6F7F7; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; background-color: #FAFAFA; font-variant-numeric: tabular-nums;" data-valign="middle" data-bgcolor="#FAFAFA">8.864520</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="example-create-basic-recipe" class="slide level2">
<h2>Example: create basic recipe</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18" data-code-line-numbers="2|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a><span class="sc">&gt;</span> <span class="co"># create recipe</span></span>
<span id="cb18-2"><a></a><span class="er">&gt;</span> aq_recipe <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(Ozone <span class="sc">~</span> ., <span class="at">data =</span> aq_df_train)</span>
<span id="cb18-3"><a></a><span class="sc">&gt;</span> </span>
<span id="cb18-4"><a></a><span class="er">&gt;</span> <span class="fu">summary</span>(aq_recipe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  variable type      role      source  
  &lt;chr&gt;    &lt;list&gt;    &lt;chr&gt;     &lt;chr&gt;   
1 Solar.R  &lt;chr [2]&gt; predictor original
2 Wind     &lt;chr [2]&gt; predictor original
3 Temp     &lt;chr [2]&gt; predictor original
4 Month    &lt;chr [2]&gt; predictor original
5 Day      &lt;chr [2]&gt; predictor original
6 Ozone    &lt;chr [2]&gt; outcome   original</code></pre>
</div>
</div>
</section>
<section id="example-summary-of-basic-recipe" class="slide level2">
<h2>Example: summary of basic recipe</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20" data-code-line-numbers="2-3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a><span class="sc">&gt;</span> <span class="co"># update roles for variables with missing data</span></span>
<span id="cb20-2"><a></a><span class="er">&gt;</span> aq_recipe <span class="ot">&lt;-</span> aq_recipe <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">update_role</span>(Ozone, Solar.R, <span class="at">new_role =</span> <span class="st">'NA_Variable'</span>)</span>
<span id="cb20-4"><a></a><span class="sc">&gt;</span> </span>
<span id="cb20-5"><a></a><span class="er">&gt;</span> <span class="fu">summary</span>(aq_recipe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  variable type      role        source  
  &lt;chr&gt;    &lt;list&gt;    &lt;chr&gt;       &lt;chr&gt;   
1 Solar.R  &lt;chr [2]&gt; NA_Variable original
2 Wind     &lt;chr [2]&gt; predictor   original
3 Temp     &lt;chr [2]&gt; predictor   original
4 Month    &lt;chr [2]&gt; predictor   original
5 Day      &lt;chr [2]&gt; predictor   original
6 Ozone    &lt;chr [2]&gt; NA_Variable original</code></pre>
</div>
</div>
</section>
<section id="example-add-recipe-steps" class="slide level2">
<h2>Example: add recipe steps</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22" data-code-line-numbers="1|2-3|4-5|6-7|8-9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a><span class="sc">&gt;</span> aq_recipe <span class="ot">&lt;-</span> aq_recipe <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a></a><span class="sc">+</span>   <span class="co"># impute Ozone missing values using the mean</span></span>
<span id="cb22-3"><a></a><span class="sc">+</span>   <span class="fu">step_impute_mean</span>(<span class="fu">has_role</span>(<span class="st">'NA_Variable'</span>), <span class="sc">-</span>Solar.R) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a></a><span class="sc">+</span>   <span class="co"># impute Solar.R missing values using knn</span></span>
<span id="cb22-5"><a></a><span class="sc">+</span>   <span class="fu">step_impute_knn</span>(<span class="fu">contains</span>(<span class="st">'.R'</span>), <span class="at">neighbors =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a></a><span class="sc">+</span>   <span class="co"># center all variable except the NA_Variable</span></span>
<span id="cb22-7"><a></a><span class="sc">+</span>   <span class="fu">step_center</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">'NA_Variable'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a></a><span class="sc">+</span>   <span class="co"># scale all variable except the NA_Variable</span></span>
<span id="cb22-9"><a></a><span class="sc">+</span>   <span class="fu">step_scale</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">'NA_Variable'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-recipe-prep-and-bake" class="slide level2">
<h2>Example: recipe prep and bake</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23" data-code-line-numbers="1-2|4-5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a><span class="sc">&gt;</span> <span class="co"># prep with training data</span></span>
<span id="cb23-2"><a></a><span class="er">&gt;</span> aq_prep_train <span class="ot">&lt;-</span> aq_recipe <span class="sc">%&gt;%</span> <span class="fu">prep</span>(aq_df_train)</span>
<span id="cb23-3"><a></a><span class="sc">&gt;</span> </span>
<span id="cb23-4"><a></a><span class="er">&gt;</span> <span class="co"># bake with testing data</span></span>
<span id="cb23-5"><a></a><span class="er">&gt;</span> aq_bake <span class="ot">&lt;-</span> aq_prep_train <span class="sc">%&gt;%</span> <span class="fu">bake</span>(aq_df_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-recipe-prep-values" class="slide level2">
<h2>Example: recipe prep values</h2>
<p>The prepped recipe is a data structure that contains any computed values.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a><span class="sc">&gt;</span> aq_prep_train <span class="sc">|&gt;</span> recipes<span class="sc">::</span><span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  number operation type        trained skip  id               
   &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;       &lt;lgl&gt;   &lt;lgl&gt; &lt;chr&gt;            
1      1 step      impute_mean TRUE    FALSE impute_mean_MkQQh
2      2 step      impute_knn  TRUE    FALSE impute_knn_zodHR 
3      3 step      center      TRUE    FALSE center_U1mlP     
4      4 step      scale       TRUE    FALSE scale_JzxDV      </code></pre>
</div>
</div>
</section>
<section id="example-recipe-prep-values-1" class="slide level2">
<h2>Example: recipe prep values</h2>
<p>We can examine any computed values by using the step number as an argument to <code>recipes::tidy</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a><span class="sc">&gt;</span> aq_prep_train <span class="sc">|&gt;</span> recipes<span class="sc">::</span><span class="fu">tidy</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  terms value id          
  &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;       
1 Wind  10.1  center_U1mlP
2 Temp  77.6  center_U1mlP
3 Month  6.91 center_U1mlP
4 Day   16.5  center_U1mlP</code></pre>
</div>
</div>
</section>
<section id="example-change-roles-again" class="slide level2">
<h2>Example: change roles again</h2>
<p>Here we update the original recipe to set the required roles.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28" data-code-line-numbers="1-2|4-5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a></a><span class="sc">&gt;</span> aq_recipe <span class="ot">&lt;-</span> aq_recipe <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">update_role</span>(Ozone, <span class="at">new_role =</span> <span class="st">'outcome'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">update_role</span>(Solar.R, <span class="at">new_role =</span> <span class="st">'predictor'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="recommended-baseline-steps" class="slide level2">
<h2>Recommended Baseline Steps</h2>
<p>Baseline preprocessing methods can be categorized as:</p>
<div style="font-size: xx-large">
<ul>
<li><strong>dummy</strong>: Do qualitative predictors require a numeric encoding (e.g., via dummy variables or other methods)?</li>
<li><strong>zv</strong>: Should columns with a single unique value be removed?</li>
<li><strong>impute</strong>: If some predictors are missing, should they be estimated via imputation?</li>
<li><strong>decorrelate</strong>: If there are correlated predictors, should this correlation be mitigated? This might mean filtering out predictors, using principal component analysis, or a model-based technique (e.g., regularization).</li>
<li><strong>normalize</strong>: Should predictors be centered and scaled?</li>
<li><strong>transform</strong>: Is it helpful to transform predictors to be more symmetric?</li>
</ul>
</div>
<p>See <a href="https://www.tmwr.org/pre-proc-table">recommended preprocessing</a> for recipe steps.</p>
</section>
<section id="available-steps" class="slide level2">
<h2>Available Steps</h2>
<ul>
<li><strong>Basic</strong>: <a href="https://recipes.tidymodels.org/reference/step_log.html">logs</a>, <a href="https://recipes.tidymodels.org/reference/step_sqrt.html">roots</a>, <a href="https://recipes.tidymodels.org/reference/step_poly.html">polynomials</a>, <a href="https://recipes.tidymodels.org/reference/step_logit.html">logits</a>, <a href="https://recipes.tidymodels.org/reference/step_hyperbolic.html">hyperbolics</a></li>
<li><strong>Encodings</strong>: <a href="https://recipes.tidymodels.org/reference/step_dummy.html">dummy variables</a>, <a href="https://recipes.tidymodels.org/reference/step_other.html">“other”</a> factor level collapsing, <a href="https://recipes.tidymodels.org/reference/discretize.html">discretization</a></li>
<li><strong>Date Features</strong>: Encodings for <a href="https://recipes.tidymodels.org/reference/step_date.html">day/doy/month</a> etc, <a href="https://recipes.tidymodels.org/reference/step_holiday.html">holiday indicators</a></li>
<li><strong>Filters</strong>: <a href="https://recipes.tidymodels.org/reference/step_corr.html">correlation</a>, <a href="https://recipes.tidymodels.org/reference/step_nzv.html">near-zero variables</a>, <a href="https://recipes.tidymodels.org/reference/step_lincomb.html">linear dependencies</a></li>
<li><strong>Imputation</strong>: <a href="https://recipes.tidymodels.org/reference/step_knnimpute.html"><em>K</em>-nearest neighbors</a>, <a href="https://recipes.tidymodels.org/reference/step_bagimpute.html">bagged trees</a>, <a href="https://recipes.tidymodels.org/reference/step_meanimpute.html">mean</a>/<a href="https://recipes.tidymodels.org/reference/step_modeimpute.html">mode</a> imputation</li>
</ul>
</section>
<section id="available-steps-1" class="slide level2">
<h2>Available Steps</h2>
<ul>
<li><strong>Normalization/Transformations</strong>: <a href="https://recipes.tidymodels.org/reference/step_center.html">center</a>, <a href="https://recipes.tidymodels.org/reference/step_scale.html">scale</a>, <a href="https://recipes.tidymodels.org/reference/step_range.html">range</a>, <a href="https://recipes.tidymodels.org/reference/step_BoxCox.html">Box-Cox</a>, <a href="https://recipes.tidymodels.org/reference/step_YeoJohnson.html">Yeo-Johnson</a></li>
<li><strong>Dimension Reduction</strong>: <a href="https://recipes.tidymodels.org/reference/step_pca.html">PCA</a>, <a href="https://recipes.tidymodels.org/reference/step_kpca.html">kernel PCA</a>, <a href="https://recipes.tidymodels.org/reference/step_ica.html">ICA</a>, <a href="https://recipes.tidymodels.org/reference/step_isomap.html">Isomap</a>, <a href="https://recipes.tidymodels.org/reference/step_depth.html">data depth</a> features, <a href="https://recipes.tidymodels.org/reference/step_classdist.html">class distances</a></li>
<li><strong>Others</strong>: <a href="https://recipes.tidymodels.org/reference/step_ns.html">spline basis functions</a>, <a href="https://recipes.tidymodels.org/reference/step_interact.html">interactions</a>, <a href="https://recipes.tidymodels.org/reference/step_spatialsign.html">spatial sign</a></li>
</ul>
<p>More on the way (i.e.&nbsp;autoencoders, more imputation methods, etc.)</p>
<p>One of the <a href="https://www.tidymodels.org/learn/develop/recipes/">package vignettes</a> shows how to write your own step functions.</p>
</section>
<section id="extending" class="slide level2">
<h2>Extending</h2>
<p>Need to add more pre-processing or other operations?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a></a><span class="sc">&gt;</span> standardized <span class="ot">&lt;-</span> rec_trained <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">step_center</span>(recipes<span class="sc">::</span><span class="fu">all_numeric</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">step_scale</span>(recipes<span class="sc">::</span><span class="fu">all_numeric</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">step_pca</span>(recipes<span class="sc">::</span><span class="fu">all_numeric</span>())</span>
<span id="cb29-5"><a></a><span class="sc">&gt;</span>           </span>
<span id="cb29-6"><a></a><span class="er">&gt;</span> <span class="do">## Only estimate the new parts:</span></span>
<span id="cb29-7"><a></a><span class="er">&gt;</span> standardized <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(standardized)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If an initial step is computationally expensive, you don’t have to redo those operations to add more.</p>
</section>
<section id="extending-1" class="slide level2">
<h2>Extending</h2>
<p>Recipes can also be created with different roles manually (note: no formula)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30" data-code-line-numbers="2|3|4|5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a></a><span class="sc">&gt;</span> rec <span class="ot">&lt;-</span> </span>
<span id="cb30-2"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">recipe</span>(<span class="at">data =</span> Sacramento) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">update_role</span>(price, <span class="at">new_role =</span> <span class="st">"outcome"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">update_role</span>(type, sqft, <span class="at">new_role =</span> <span class="st">"predictor"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">update_role</span>(zip, <span class="at">new_role =</span> <span class="st">"strata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Also, the sequential nature of steps means that steps don’t have to be R operations and could call other compute engines (e.g.&nbsp;Weka, scikit-learn, Tensorflow, etc. )</p>
</section>
<section id="extending-2" class="slide level2">
<h2>Extending</h2>
<p>We can create wrappers to work with recipes too:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31" data-code-line-numbers="2|3-6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a></a><span class="sc">&gt;</span> lin_reg.recipe <span class="ot">&lt;-</span> <span class="cf">function</span>(rec, data, ...) {</span>
<span id="cb31-2"><a></a><span class="sc">+</span>   trained <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">prep</span>(rec, <span class="at">training =</span> data)</span>
<span id="cb31-3"><a></a><span class="sc">+</span>   <span class="fu">lm.fit</span>(</span>
<span id="cb31-4"><a></a><span class="sc">+</span>     <span class="at">x =</span> recipes<span class="sc">::</span><span class="fu">bake</span>(trained, <span class="at">newdata =</span> data, <span class="fu">all_predictors</span>())</span>
<span id="cb31-5"><a></a><span class="sc">+</span>     , <span class="at">y =</span> recipes<span class="sc">::</span><span class="fu">bake</span>(trained, <span class="at">newdata =</span> data, <span class="fu">all_outcomes</span>())</span>
<span id="cb31-6"><a></a><span class="sc">+</span>     , ...</span>
<span id="cb31-7"><a></a><span class="sc">+</span>   )</span>
<span id="cb31-8"><a></a><span class="sc">+</span> }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="an-example" class="slide level2">
<h2>An Example</h2>
<p><a href="http://appliedpredictivemodeling.com">Kuhn and Johnson</a> (2013) analyze a data set where thousands of cells are determined to be well-segmented (WS) or poorly segmented (PS) based on 58 image features. We would like to make predictions of the segmentation quality based on these features.</p>
<div style="font-size: smaller">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>The dataset <code>segmentationData</code> is in the package <code>caret</code> and represents the results of automated microscopy to collect images of cultured cells. The images are subjected to segmentation algorithms to identify cellular structures and quantitate their morphology, for hundreds to millions of individual cells.</p>
</div>
</div>
</div>
</div>
</section>
<section id="an-example-1" class="slide level2">
<h2>An Example</h2>
<p>The <code>segmentationData</code> dataset has 61 columns</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32" data-code-line-numbers="1|3-5|7-9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a></a><span class="sc">&gt;</span> <span class="fu">data</span>(segmentationData, <span class="at">package =</span> <span class="st">"caret"</span>)</span>
<span id="cb32-2"><a></a><span class="sc">&gt;</span> </span>
<span id="cb32-3"><a></a><span class="er">&gt;</span> seg_train <span class="ot">&lt;-</span> segmentationData <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a></a><span class="sc">+</span>   dplyr<span class="sc">::</span><span class="fu">filter</span>(Case <span class="sc">==</span> <span class="st">"Train"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-5"><a></a><span class="sc">+</span>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Case)</span>
<span id="cb32-6"><a></a><span class="sc">&gt;</span> </span>
<span id="cb32-7"><a></a><span class="er">&gt;</span> seg_test  <span class="ot">&lt;-</span> segmentationData <span class="sc">%&gt;%</span> </span>
<span id="cb32-8"><a></a><span class="sc">+</span>   dplyr<span class="sc">::</span><span class="fu">filter</span>(Case <span class="sc">==</span> <span class="st">"Test"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb32-9"><a></a><span class="sc">+</span>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Case)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="a-simple-recipe" class="slide level2">
<h2>A Simple Recipe</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33" data-code-line-numbers="1|3-7|8-10|12-19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a></a><span class="sc">&gt;</span> rec <span class="ot">&lt;-</span> recipes<span class="sc">::</span><span class="fu">recipe</span>(Class  <span class="sc">~</span> ., <span class="at">data =</span> seg_train)</span>
<span id="cb33-2"><a></a><span class="sc">&gt;</span> </span>
<span id="cb33-3"><a></a><span class="er">&gt;</span> basic <span class="ot">&lt;-</span> rec <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a></a><span class="sc">+</span>   <span class="co"># the column Cell contains identifiers</span></span>
<span id="cb33-5"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">update_role</span>(Cell, <span class="at">new_role =</span> <span class="st">'ID'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a></a><span class="sc">+</span>   <span class="co"># Correct some predictors for skewness</span></span>
<span id="cb33-7"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">step_YeoJohnson</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb33-8"><a></a><span class="sc">+</span>   <span class="co"># Standardize the values</span></span>
<span id="cb33-9"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">step_center</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb33-10"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">step_scale</span>(recipes<span class="sc">::</span><span class="fu">all_predictors</span>())</span>
<span id="cb33-11"><a></a><span class="sc">&gt;</span> </span>
<span id="cb33-12"><a></a><span class="er">&gt;</span> <span class="co"># Estimate the transformation and standardization parameters </span></span>
<span id="cb33-13"><a></a><span class="er">&gt;</span> basic <span class="ot">&lt;-</span> </span>
<span id="cb33-14"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">prep</span>(</span>
<span id="cb33-15"><a></a><span class="sc">+</span>     basic</span>
<span id="cb33-16"><a></a><span class="sc">+</span>     , <span class="at">training =</span> seg_train</span>
<span id="cb33-17"><a></a><span class="sc">+</span>     , <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb33-18"><a></a><span class="sc">+</span>     , <span class="at">retain =</span> <span class="cn">TRUE</span></span>
<span id="cb33-19"><a></a><span class="sc">+</span>   )  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div style="font-size: smaller">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>The Yeo-Johnson is similar to the Box-Cox method, however it allows for the transformation of nonpositive data as well. A Box Cox transformation is a transformation of non-normal dependent variables into a normal shape. Both transformations have a single parameter <span class="math inline">\(\lambda\)</span>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="a-simple-recipe-1" class="slide level2">
<h2>A Simple Recipe</h2>
<p>We can examine the center, scale, and Yeo Johnson parameters computed for each continuous measurement.</p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Yeo Johnson</a></li><li><a href="#tabset-2-2">means</a></li><li><a href="#tabset-2-3">std deviations</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a></a><span class="sc">&gt;</span> basic <span class="sc">|&gt;</span> recipes<span class="sc">::</span><span class="fu">tidy</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 54 × 3
   terms                value id              
   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;           
 1 AngleCh1             0.806 YeoJohnson_xyKY3
 2 AreaCh1             -0.861 YeoJohnson_xyKY3
 3 AvgIntenCh1         -0.340 YeoJohnson_xyKY3
 4 AvgIntenCh2          0.434 YeoJohnson_xyKY3
 5 AvgIntenCh3          0.219 YeoJohnson_xyKY3
 6 AvgIntenCh4          0.213 YeoJohnson_xyKY3
 7 DiffIntenDensityCh1 -0.929 YeoJohnson_xyKY3
 8 DiffIntenDensityCh3  0.116 YeoJohnson_xyKY3
 9 DiffIntenDensityCh4  0.112 YeoJohnson_xyKY3
10 EntropyIntenCh1     -0.440 YeoJohnson_xyKY3
# ℹ 44 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a></a><span class="sc">&gt;</span> basic <span class="sc">|&gt;</span> recipes<span class="sc">::</span><span class="fu">tidy</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 58 × 3
   terms                    value id          
   &lt;chr&gt;                    &lt;dbl&gt; &lt;chr&gt;       
 1 AngleCh1                45.0   center_t2Q3m
 2 AreaCh1                  1.15  center_t2Q3m
 3 AvgIntenCh1              2.24  center_t2Q3m
 4 AvgIntenCh2             17.4   center_t2Q3m
 5 AvgIntenCh3              6.99  center_t2Q3m
 6 AvgIntenCh4              7.56  center_t2Q3m
 7 ConvexHullAreaRatioCh1   1.21  center_t2Q3m
 8 ConvexHullPerimRatioCh1  0.893 center_t2Q3m
 9 DiffIntenDensityCh1      1.05  center_t2Q3m
10 DiffIntenDensityCh3      5.15  center_t2Q3m
# ℹ 48 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a></a><span class="sc">&gt;</span> basic <span class="sc">|&gt;</span> recipes<span class="sc">::</span><span class="fu">tidy</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 58 × 3
   terms                      value id         
   &lt;chr&gt;                      &lt;dbl&gt; &lt;chr&gt;      
 1 AngleCh1                21.1     scale_x4O89
 2 AreaCh1                  0.00334 scale_x4O89
 3 AvgIntenCh1              0.204   scale_x4O89
 4 AvgIntenCh2              9.42    scale_x4O89
 5 AvgIntenCh3              2.50    scale_x4O89
 6 AvgIntenCh4              3.04    scale_x4O89
 7 ConvexHullAreaRatioCh1   0.210   scale_x4O89
 8 ConvexHullPerimRatioCh1  0.0777  scale_x4O89
 9 DiffIntenDensityCh1      0.00929 scale_x4O89
10 DiffIntenDensityCh3      1.37    scale_x4O89
# ℹ 48 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="more-sophisticated-steps-pca" class="slide level2">
<h2>More sophisticated steps: PCA</h2>
<p>Principal Component Analysis (PCA) is a technique used in data analysis to simplify a large dataset (many measurements/columns) by reducing its number of dimensions (columns) while still retaining as much important information as possible.</p>
<p>A pretty good description of PCA can be found <a href="https://towardsdatascience.com/singular-value-decomposition-and-its-applications-in-principal-component-analysis-5b7a5f08d0bd">here</a>.</p>
</section>
<section id="more-sophisticated-steps-pca-1" class="slide level2">
<h2>More sophisticated steps: PCA</h2>
<p>PCA step-by-step:</p>
<div style="font-size: 65%">
<ol type="1">
<li><strong>Standardize the Data</strong>:
<ul>
<li>Before applying PCA, we often standardize the data, which means adjusting all variables to have the same scale. This is important because PCA is sensitive to the scale of the data.</li>
</ul></li>
<li><strong>Find the Principal Components</strong>:
<ul>
<li>PCA identifies the directions (principal components) in which the data varies the most. Think of these as new axes in a new coordinate system that best capture the variation in the data.</li>
<li>The first principal component captures the most variation. The second principal component is orthogonal (at a right angle) to the first and captures the next most variation, and so on.</li>
</ul></li>
<li><strong>Transform the Data</strong>:
<ul>
<li>We then transform the original data into this new set of principal components. Each data point can now be represented in terms of these principal components rather than the original variables.</li>
</ul></li>
</ol>
</div>
</section>
<section id="more-sophisticated-steps-pca-2" class="slide level2">
<h2>More sophisticated steps: PCA</h2>
<div style="font-size: 65%">
<p>You have test scores in Math, Science, and English. You want to find a way to understand overall performance without looking at all three subjects separately.</p>
<ol type="1">
<li><p><strong>Original Data</strong>: You have three scores for each student: Math, Science, and English.</p></li>
<li><p><strong>Standardize the Data</strong>: You adjust the scores so that Math, Science, and English scores are on the same scale.</p></li>
<li><p><strong>Find Principal Components</strong>:</p>
<ul>
<li>PCA finds that the first principal component might be a combination of Math and Science scores, capturing the overall academic ability in quantitative subjects.</li>
<li>The second principal component might represent the difference between scores in English and the average of Math and Science scores, capturing a different aspect of performance.</li>
</ul></li>
<li><p><strong>Transform the Data</strong>:</p>
<ul>
<li>Each student’s performance can now be described using these new principal components instead of the original scores. For example, a student might have a high score on the first principal component (strong in Math and Science) but a lower score on the second (relatively weaker in English).</li>
</ul></li>
</ol>
</div>
</section>
<section id="more-sophisticated-steps-pca-3" class="slide level2">
<h2>More sophisticated steps: PCA</h2>
<div style="font-size: 75%">
<p><strong>Benefits of PCA</strong></p>
<ul>
<li><strong>Simplification</strong>: Reduces the number of variables, making it easier to analyze and visualize the data.</li>
<li><strong>Noise Reduction</strong>: Helps to remove noise from the data by focusing on the main components that capture the most variation.</li>
<li><strong>Feature Extraction</strong>: Identifies the most important variables (principal components) that explain the majority of the variance in the data.</li>
</ul>
<p>PCA is like finding the most important “directions” in your data, where most of the interesting stuff happens. It helps you see the big picture by reducing complexity while keeping the essential information. This makes it a powerful tool for data analysis, especially when dealing with high-dimensional datasets.</p>
</div>
</section>
<section id="principal-component-analysis" class="slide level2">
<h2>Principal Component Analysis</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40" data-code-line-numbers="1|2|3-4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a></a><span class="sc">&gt;</span> pca <span class="ot">&lt;-</span> basic <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">step_pca</span>(</span>
<span id="cb40-3"><a></a><span class="sc">+</span>     recipes<span class="sc">::</span><span class="fu">all_predictors</span>()</span>
<span id="cb40-4"><a></a><span class="sc">+</span>     , <span class="at">num_comp =</span> <span class="dv">5</span></span>
<span id="cb40-5"><a></a><span class="sc">+</span>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 4
   variable                type      role      source  
   &lt;chr&gt;                   &lt;list&gt;    &lt;chr&gt;     &lt;chr&gt;   
 1 Cell                    &lt;chr [2]&gt; ID        original
 2 AngleCh1                &lt;chr [2]&gt; predictor original
 3 AreaCh1                 &lt;chr [2]&gt; predictor original
 4 AvgIntenCh1             &lt;chr [2]&gt; predictor original
 5 AvgIntenCh2             &lt;chr [2]&gt; predictor original
 6 AvgIntenCh3             &lt;chr [2]&gt; predictor original
 7 AvgIntenCh4             &lt;chr [2]&gt; predictor original
 8 ConvexHullAreaRatioCh1  &lt;chr [2]&gt; predictor original
 9 ConvexHullPerimRatioCh1 &lt;chr [2]&gt; predictor original
10 DiffIntenDensityCh1     &lt;chr [2]&gt; predictor original
# ℹ 50 more rows</code></pre>
</div>
</div>
</section>
<section id="principal-component-analysis-1" class="slide level2">
<h2>Principal Component Analysis</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a></a><span class="sc">&gt;</span> pca <span class="sc">%&lt;&gt;%</span> recipes<span class="sc">::</span><span class="fu">prep</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">summary</a></li><li><a href="#tabset-3-2">components</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a></a><span class="sc">&gt;</span> pca <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  variable type      role      source  
  &lt;chr&gt;    &lt;list&gt;    &lt;chr&gt;     &lt;chr&gt;   
1 Cell     &lt;chr [2]&gt; ID        original
2 Class    &lt;chr [3]&gt; outcome   original
3 PC1      &lt;chr [2]&gt; predictor derived 
4 PC2      &lt;chr [2]&gt; predictor derived 
5 PC3      &lt;chr [2]&gt; predictor derived 
6 PC4      &lt;chr [2]&gt; predictor derived 
7 PC5      &lt;chr [2]&gt; predictor derived </code></pre>
</div>
</div>
</div>
<div id="tabset-3-2">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a></a><span class="sc">&gt;</span> pca <span class="sc">%&gt;%</span> recipes<span class="sc">::</span><span class="fu">tidy</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,364 × 4
   terms                      value component id       
   &lt;chr&gt;                      &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;    
 1 AngleCh1                 0.00521 PC1       pca_AXbdX
 2 AreaCh1                  0.0823  PC1       pca_AXbdX
 3 AvgIntenCh1             -0.204   PC1       pca_AXbdX
 4 AvgIntenCh2             -0.209   PC1       pca_AXbdX
 5 AvgIntenCh3             -0.0873  PC1       pca_AXbdX
 6 AvgIntenCh4             -0.203   PC1       pca_AXbdX
 7 ConvexHullAreaRatioCh1   0.191   PC1       pca_AXbdX
 8 ConvexHullPerimRatioCh1 -0.181   PC1       pca_AXbdX
 9 DiffIntenDensityCh1     -0.185   PC1       pca_AXbdX
10 DiffIntenDensityCh3     -0.0760  PC1       pca_AXbdX
# ℹ 3,354 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="principal-component-analysis-2" class="slide level2">
<h2>Principal Component Analysis</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47" data-code-line-numbers="2|3|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a></a><span class="sc">&gt;</span> pca <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb47-2"><a></a><span class="sc">+</span>   recipes<span class="sc">::</span><span class="fu">bake</span>(</span>
<span id="cb47-3"><a></a><span class="sc">+</span>     <span class="at">new_data =</span> seg_test</span>
<span id="cb47-4"><a></a><span class="sc">+</span>     , <span class="fu">everything</span>()</span>
<span id="cb47-5"><a></a><span class="sc">+</span>   )</span>
<span id="cb47-6"><a></a><span class="sc">&gt;</span> pca[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
       Cell Class   PC1    PC2    PC3    PC4   PC5
      &lt;int&gt; &lt;fct&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 207827637 PS     4.86 -5.85  -0.891 -4.13  1.84 
2 207932455 PS     3.28 -1.51   0.353 -2.24  0.441
3 207827656 WS    -7.03 -1.77  -2.42  -0.652 3.22 
4 207827659 WS    -6.96 -2.08  -2.89  -1.79  3.20 
5 207827661 PS     6.52 -3.77  -0.924 -2.61  2.49 
6 207932479 WS     2.87  1.66   1.75  -5.41  0.324
7 207932480 WS     2.72  0.433 -1.05  -5.45  1.18 
8 207827711 WS    -3.01  1.94   2.68  -0.409 3.55 </code></pre>
</div>
</div>
</section>
<section id="principal-component-analysis-3" class="slide level2">
<h2>Principal Component Analysis</h2>
<div class="cell" data-layout-align="center" width="80%">
<details class="code-fold">
<summary>PCs are predictive</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a></a><span class="sc">&gt;</span> pca <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">color =</span> Class)) <span class="sc">+</span> </span>
<span id="cb49-2"><a></a><span class="sc">+</span>   <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb49-3"><a></a><span class="sc">+</span>   <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="BSMM_8740_lec_03_files/figure-revealjs/image_pca_plot-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="recap" class="slide level2">
<h2>Recap</h2>
<ul>
<li>We’ve used the Recipes package to create a workflow for data pre-processing and feature engineering</li>
<li>The <code>recipe</code> verbs define the pre-processing and feature engineering steps</li>
<li>using the recipe object, the verb <code>prep</code> prepares the data on a training set, storing the meta-parameters.</li>
<li>the verb <code>bake</code> applies the prepped recipe to new data, using the meta-parameters.</li>
</ul>
</section>
<section class="slide level2">


<div class="quarto-auto-generated-content">
<p><img src="images/logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://bsmm-8740-fall-2024.github.io/osb/">bsmm-8740-fall-2024.github.io/osb</a></p>
</div>
</div>
</section></section>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="../site_libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true,"numbers":true},
'multiplex': {"secret":null,"id":"acd02a16f3876c22","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/bsmm-8740-fall-2024\.github\.io\/osb\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>